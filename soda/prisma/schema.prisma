generator client {
  provider = "prisma-client-js"
  binaryTargets = ["linux-musl", "native"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id    Int     @id @default(autoincrement())

  email String  @unique
  name  String?
  dateOfBirth DateTime?
  phone String? @unique

  password String?
  cart CartItem[]
  orders Order[]

  addresses Address[]

  role    Role     @default(USER)
  profile Profile?

  active Boolean @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Profile {
  id      Int     @id @default(autoincrement())
  bio     String

  user    User    @relation(fields: [userId], references: [id])
  userId  Int    // relation scalar field (used in the `@relation` attribute above)

  active Boolean @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum Role {
  USER
}

model Inventory {
  id    Int     @id @default(autoincrement())
  name  String?
  description  String?
  product Product?
  inventoryCount Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum OrderStatus {
  PENDING
  PAYMENT_FAILED
  UNSHIPPED
  CONFIRMED
  SHIPPED
  CANCELLED
}

model Order {
  id        Int      @id @default(autoincrement())
  amount Float

  // relations
  user    User?    @relation(fields: [userId], references: [id])
  userId  Int?

  address    Address?    @relation(fields: [addressId], references: [id])
  addressId  Int?

  active    Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model CartItem {
  id        Int      @id @default(autoincrement())
  quantity Int

  user    User?    @relation(fields: [userId], references: [id])
  userId  Int?

  product Product?

  active    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Address {
  id    Int     @id @default(autoincrement())
  fullname  String?

  address  String? // full address

  town String?
  region String?
  nearby String?

  zipcode String?
  city String?
  country String?

  user    User?    @relation(fields: [userId], references: [id])
  userId  Int?

  orders Order[]

  active    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model ProductDetails {
  id        Int      @id @default(autoincrement())
  product Product?
  size String
  color String
  // images ...
  // tags
  // categories etc..
  // other product details...
}

model Product {
  id        Int      @id @default(autoincrement())
  title     String
  description   String?

  productDetails    ProductDetails?    @relation(fields: [productDetailsId], references: [id])
  productDetailsId  Int?

  published Boolean  @default(false)

  price Float

  inventory    Inventory?    @relation(fields: [inventoryId], references: [id])
  inventoryId  Int?

  cartItem    CartItem?    @relation(fields: [cartItemId], references: [id])
  cartItemId  Int?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
